seed: 2222
clean: False
debug: False
result: evaluate  # evaluate, instance_numbers, sagittalcenters

directories:
  relative_directory: /data/phalendj/kaggle/rsna2024
  image_directory: train_images


dataset:
  name: LevelCubeLeftRightDataset
  image_size: [512, 512]
  series_description: Axial T2
  conditions: ['Left Subarticular Stenosis', Right Subarticular Stenosis]
  # series_description: Sagittal T1
  # conditions: ['Left Neural Foraminal Narrowing', Right Neural Foraminal Narrowing]
  channels: 5
  subsize: 64
  aug_size: 0.1
  # center_file: /home/phalendj/code/rsna2024/outputs/2024-08-16/15-40-19/all_predicted_center_coordinates.csv
  center_file: /data/phalendj/kaggle/rsna2024/train_label_coordinates.csv
  augmentations:
    prob: 0.75
    normalize: True  # Helpful with generalization
    hflip: False   # Very hurtful usually - cannot segment properly and everything comes in standard locations
    contrast: True  # Not much change
    blur: True   # This is a major adjustment that helps with training.
    distort: True  # This is a major adjustment that helps with training.  This one does the most to keep training and val in line, however it may prevent training from getting too good 
    rotate: True  # This is a major adjustment that helps with training.
    crop:   # 0.9 Does not do much - Maybe crop more? 0.7 hurts
      use: False
      size: 512
    channel_shuffle: False  # Removes all the information for TDCNN
    sharpen: False
  
  

loss:
  name: WeightedCrossEntropy
  # name: InstanceCrossEntropy
  # name: SevereLoss
  # name: HeatmapLoss
  # patch_size: 512
  
model:
  name: tdcnnlevelside
  model_name: densenet121
  nclasses: 3
  subsize: 64
  num_layers: 4

optimization:
  optimizer: AdamW
  scheduler: CosineWithWarmup
  learning_rate: 1.0e-4
  weight_decay: 1.e-2
  n_cycles: 0.475

training:
  use_folds: [0, 1, 2, 3, 4]
  # use_folds: [2]
  use_amp: True
  epochs: 15
  batch_size: 16
  grad_acc: 1
  early_stopping: 3
  workers: 12

